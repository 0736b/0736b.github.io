<!DOCTYPE html>
<html lang="en">
	<head>
		<title>ùîó ùî• ùîû ùî´ ùîû ùî¥ ùîû ùî±</title>
		<meta charset="utf-8" />
		<link rel="icon" href="../favi.jpg" />
		<meta name="viewport" content="width=device-width" />
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link rel="preload" href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&family=Rubik:wght@400&display=swap" as="style">
		<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=Rubik:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
		<noscript>
		   <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=Rubik:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
		</noscript>
		<meta http-equiv="content-security-policy" content="">
		<link href="../_app/immutable/assets/_layout-3c819bbd.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/start-9eff54af.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index-677aa875.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/singletons-bd41dc6b.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preload-helper-9b728935.js">
		<link rel="modulepreload" href="../_app/immutable/components/pages/_layout.svelte-c71ac73a.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/stores-3f6582b5.js">
		<link rel="modulepreload" href="../_app/immutable/modules/pages/_layout.js-872bd3f4.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/_layout-80922366.js">
		<link rel="modulepreload" href="../_app/immutable/components/pages/blog/_slug_/_page.svelte-6ead797e.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index-5804e728.js">
		<link rel="modulepreload" href="../_app/immutable/modules/pages/blog/_slug_/_page.js-9cf18d19.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/_page-ed7a37b8.js">
	</head>
	<body data-sveltekit-preload-data="hover" class="bg-black scroll-smooth">
		<div style="display: contents">


<div class="container mx-auto max-w-3xl font-rubik text-xl text-center my-8 text-[#D4D4D4]"><a href="/" class="font-thin italic lowercase px-4 tracking-tighter text-glow hover:text-white transition-all"><span><span>Home</span></span></a>
	<a href="/blog" class="font-thin italic lowercase px-4 text-glow tracking-tighter hover:text-white transition-all"><span class="font-bold"><span class="underline">Blog</span></span></a>
	<a href="/project" class="font-thin italic lowercase px-4 text-glow tracking-tighter hover:text-white transition-all"><span><span>Project</span></span></a></div>
  

<main><div class="container mx-auto max-w-6xl font-rubik"><div class="container mx-auto max-w-4xl prose prose-invert prose-pre:rounded-none font-robotomono mb-20 pb-20 mt-16 border border-[#444444] text-[#D4D4D4] p-12"><h1 class="banner-active uppercase font-rubik font-black text-3xl lg:text-5xl text-white">Setup VM for reverse engineering</h1>
		<div class="tag"><span class="font-rubik px-2 text-sm bg-[#D4D4D4] text-black">VMware, Windows</span></div>
		<span class="font-robotomono text-xl text-[#D4D4D4]">December 10, 2022</span>
		<div class="font-sans font-light"><h3>Create a Virtual Machine on VMware</h3>
<p>I‚Äôm using ReviOS‚Äôs Windows 10 Pro 1709 Optimized and Bloatware Removed version.
Choose Custom Configuration from the list of options in the virtual machine creation section (advanced). The following are important parameters.</p>
<ol><li>Firmware type: UEFI and Secure Boot disabled</li>
<li>Network connection: NAT</li></ol>
<p>Consider your resources when making adjustments to the processors, memory, and hard drive.</p>
<p>After that, install Windows as usual.</p>
<p><img src="/blog_imgs/1709-task-mgr.png" alt="1709-task-mgr"></p>
<p>We now have a Windows virtual machine, and I‚Äôve explained why I prefer Windows to ReviOS because it uses so little RAM. Only 0.7 GB of RAM is required for Fresh Install.</p>
<h3>Post-Install</h3>
<p>The next stage will be to install the apps and equipment required for game hacking after Windows has been installed.</p>
<p>It‚Äôs crucial that we avoid installing VMware tools because some games won‚Äôt let us launch them if they detect that we are running a VM.</p>
<p>For the reverse engineering game process, I installed these useful programs.</p>
<h5>Programs list</h5>
<ul><li>Browser: Brave</li>
<li>File archiver: 7-Zip</li>
<li>Debugger: x64dbg</li>
<li>Disassembler: IDA Pro</li>
<li>Kernel explorer: Windows Kernel Explorer (WKE)</li>
<li>Anti-rootkit: OpenArk</li>
<li>IDE and Code editor: VS 2019, VS Code, Lazarus, HxD, Notepad++</li></ul>
<p>WKE and OpenArk are useful and practical programs. because the Reverse tab shows that we can access a lot of kernel and that OpenArk can download more reverse tools from within the software.</p>
<p><img src="/blog_imgs/open-ark.png" alt="open-ark"></p>
<p>Following the installation of these programs, we‚Äôll deal with Patchguard, which will make it easy to load and test kernel drivers and includes the necessary kernel drivers that hide VMs and debuggers from games.</p>
<h4>Disable PatchGuard and DSE with EfiGuard</h4>
<p>I‚Äôm using EfiGuard <a href="https://github.com/Mattiwatti/EfiGuard" rel="nofollow">EfiGuard</a> which is a UEFI bootkit that will allow us to disable PatchGuard and toggle Driver Signature Enforcement (DSE)</p>
<p>after we download <code>EfiGuard.zip</code>, when we open it we will found the file <code>EfiDSEFix.exe</code> and folder <code>EFI</code> then</p>
<ol><li>Open Powershell (Run as admin)</li>
<li>type the command <code>mountvol B: /S</code> for Mounts EFI system partition</li></ol>
<p><img src="/blog_imgs/mountvol.png" alt="mountvol"></p>
<p>You will see that Drive B: is displayed.</p>
<ol start="3"><li>Go to <code>B:\EFI\Boot</code> and Copy <code>EfiGuardDxe.efi</code>, <code>Loader.efi</code> from <code>EfiGuard.zip\EFI\Boot\</code></li></ol>
<p><img src="/blog_imgs/efi-copy1.png" alt="efi-copy"></p>
<ol start="4"><li><p>Copy <code>EfiDSEFix.exe</code> from <code>EfiGuard.zip</code> paste it at <code>C:</code></p></li>
<li><p>Now Restart VM and press the F2 key repeatly until you enter the Boot Manager</p></li></ol>
<p><img src="/blog_imgs/boot-mgr.png" alt="boot-mgr"></p>
<ol start="6"><li>go to <code>Enter setup ‚Üí Configure boot options ‚Üí Add boot option ‚Üí select NO VOLUME LABEL ‚Üí EFI ‚Üí Boot</code> will found files <code>Loader.efi, EfiGuardDxe.efi</code></li></ol>
<p><img src="/blog_imgs/efi-found.png" alt="efi-found"></p>
<ol start="7"><li>press Enter select <code>Loader.efi</code> and enter Input the description <code>EfiGuard</code></li></ol>
<p><img src="/blog_imgs/modify-efi.png" alt="modify-efi"></p>
<ol start="8"><li><p>press <code>Commit changes and exit</code> will go back to Boot Manager</p></li>
<li><p>Now go to <code>Configure boot options ‚Üí Change boot order ‚Üí Change the order ‚Üí Move EfiGuard to the top</code></p></li></ol>
<p><img src="/blog_imgs/boot-order.png" alt="boot-order"></p>
<ol start="10"><li><p><code>Commit change</code> and <code>Exit boot manager ‚Üí Shutdown</code></p></li>
<li><p>Reopen the VM and if installed properly, you will see the EfiGuard Boot page as follows.</p></li></ol>
<p><img src="/blog_imgs/efi-boot.png" alt="efi-boot"></p>
<p>That‚Äôs all, now we can start and disable DSE through <code>EfiDSEFix.exe</code> to load and use the Unsigned driver.</p>
<p>by typing</p>
<pre class="language-powershell"><!-- HTML_TAG_START --><code class="language-powershell">EfiDSEFix<span class="token punctuation">.</span>exe <span class="token operator">-</span>d <span class="token punctuation">(</span><span class="token keyword">for</span> disable DSE<span class="token punctuation">)</span>
EfiDSEFix<span class="token punctuation">.</span>exe <span class="token operator">-</span>e <span class="token punctuation">(</span><span class="token keyword">for</span> enable DSE<span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre>
<p><img src="/blog_imgs/efi-check.png" alt="efi-check"></p>
<h4>Hiding x64dbg with TitanHide</h4>
<p>TitanHide is a driver to hide the debugger from the process. <a href="https://github.com/mrexodia/TitanHide" rel="nofollow">TitanHide</a></p>
<p>Installation</p>
<pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">1. Copy folder &#96;Plugin&#96; from &#96;TitanHide.zip&#96; to folder &#96;x32/x64&#96; in x64dbg directory
2. Copy &#96;TitanHide.sys&#96; to &#96;%systemroot%system32drivers&#96;
3. Run the command &#96;sc create TitanHide binPath= %systemroot%system32driversTitanHide.sys type= kernel&#96; to create the TitanHide service
4. Run the command &#96;sc start TitanHide to start the TitanHide&#96; service.</code><!-- HTML_TAG_END --></pre>
<p><img src="/blog_imgs/titanhide-ins.png" alt="titanhide-ins"></p>
<h4>Hiding VM with VMwareHardenedLoader</h4>
<p>To hide VMware from some Anti-vm <a href="https://github.com/hzqst/VmwareHardenedLoader" rel="nofollow">VMHardenedLoader</a></p></div></div></div></main>


		<script type="module" data-sveltekit-hydrate="12znezy">
			import { start } from "../_app/immutable/start-9eff54af.js";

			start({
				env: {},
				paths: {"base":"","assets":""},
				target: document.querySelector('[data-sveltekit-hydrate="12znezy"]').parentNode,
				version: "1727603886964",
				hydrate: {
					node_ids: [0, 4],
					data: [null,null],
					form: null
				}
			});
		</script>
	</div>
	</body>
</html>
